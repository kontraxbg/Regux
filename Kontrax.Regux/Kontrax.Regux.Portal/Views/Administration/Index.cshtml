@model IEnumerable<Kontrax.Regux.Model.Administration.AdministrationIndexModel>

@{
    ViewBag.Title = "Списък с администрации";
}

@helper ShowTree(IEnumerable<Kontrax.Regux.Model.Administration.AdministrationIndexModel> items)
{
        foreach (var item in items)
        {

            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.Code)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.ParentId)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Name)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.HasCertificate)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.CertificateIsPending)
                </td>
                <td>
                    <div class="text-nowrap">
                        <a href="@Url.Action("Details", new { id=item.Id })"><span class="glyphicon glyphicon-eye-open" data-toggle="tooltip" title="детайли"></span></a>
                        <a href="@Url.Action("Edit", new { id=item.Id })"><span class="glyphicon glyphicon-edit" data-toggle="tooltip" title="редакция"></span></a>
                        <a href="@Url.Action("Delete", new { id=item.Id })"><span class="glyphicon glyphicon-trash" data-toggle="tooltip" title="изтрий"></span></a>
                    </div>
                </td>
            </tr>

             @ShowTree(Model.Where(i=>i.ParentId == item.Id))
        }
}

<table class="table table-hover">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Code)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.ParentId)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.HasCertificate)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.CertificateIsPending)
        </th>
        <th></th>
    </tr>

    @ShowTree(Model.Where(i=>i.ParentId == null))
</table>
